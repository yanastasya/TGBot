# TGBot
dev-bridge-backend-tg-bot
Telegram бот - посредник между пользователями и администраторами.

Для чего нужен этот бот?
    Для того, чтобы пользователь мог задать вопрос команде проекта. Администраторы могли увидеть это вопрос в закрытом чате, обсудить его и написать ответ. Пользователь получает ответ от имени бота.

Сценарий поведения бота:

    1) Пользователь открывает чат с ботом, Нажимает /start:
        бот присылает сообщение 'Добрый день! Выберите, пожалуйста, тему обращения!' и 4 кнопки для выбора темы обращения: Сотрудничество, Баги, Платформа, Другое.

    NB! Если после команды /start пользователь отвечает боту иным способом, кроме как нажатием кнопки с темой обращения, бот пришлет ему сообщеие: 'Пожалуйста, выберите тему обращения, нажав одну из кнопок. Если вы передумали задавать вопрос - отправьте команду /cancel.'        

    2) Пользователь выбирает тему:
        Бот отвечает: 'Спасибо! А теперь введите ваш вопрос.'
      

    3) Пользователь пишет вопрос. Он может быть как текстовый, так и любой другой.:
        Бот пересылает сообщение в группу администраторов (свободную от работы с обращеними в данный момент), а пользователю бот отвечает: 'Благодарим за интерес к нашему проекту! Наша команда уже работает над вашим обращением и скоро вы увидите ответ.'

    NB! Для работы бота должно быть создано несколько чатов для работы с обращениями пользователей. Бот должен быть участником этих чатов и иметь права администратора в них. Предполагается, что пока в чате идёт работа с обращением одного пользователя, то туда поступают только сообщения от этого пользователя. Когда вопрос исчерпан, администратор нажимает кнопку "закрыть обращение", и чат становится "свободным" - т.е. готов принять следующее обращение. 
    Также создаётся один дополнительный чат, куда будут пересылаться обращения в случае, если основные чаты заняты. Для дополнительного чата нет ограничений на колличество обращений, рассматриваемых в нём одновременно. 

    4) Когда в чат администраторов приходит первое сообщение от пользователя, то происходит следующее:
        - бот меняет название чата на тему соответствующего обращения
        - под содержанием обращения появляется кнопка "закрыть обращение"

    5) все остальные сообщения пользователя в чат с ботом, кроме первого, приходят в чат администраторов в виде пересланного сообщения    

    6) Получив обращение, администраторы могут обсудить его между собой, отправляя сообщения в чат, можно использовать reply на сообщения друг друга. Эта переписка остаётся внутри чата. Для отправки ответа пользователю необходимо делать Reply на сообщения бота (пересланные собщения от пользователя).

    7) Когда вопрос исчерпан, администратор нажимает "закрыть обращение". После чего бот уточняет: 'Вы уверены, что хотите закрыть обращение?' (к сообщению прикрепляются 2 кнопки да/нет). При ответе нет можно продолжить работу с обращением в данном чате. 
    При ответе ДА:
        бот возвращает название чата в исходное;
        сохраняет в базу данных тему обращения, дату/время его открытия и закрытия;
        просит администратора очистить чат,
        отправляет пользователю сообщение: 'Ваше обращение было закрыто. Вы выяснили всё,что хотели?'. Вопрос риторический, т.к. не зависимо от ответа пользователя (кнопки да/нет), ему будет предложено воспользоваться командой /start при желании задать новый вопрос.




